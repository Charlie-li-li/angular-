!function(e){"use strict";e.module("directives",[]),e.module("services",[]),e.module("moneyMarketApp",["ui.router","oc.lazyLoad","ui.bootstrap","directives","services","ui.grid","ui.grid.infiniteScroll","ngCookies","ngFileUpload"]);var n=e.module("moneyMarketApp").run(["userinfoService",function(e){e.validate()}]).constant("enumConfig",{quoteType:{GTF:"保本",UR2:"非保本R2",UR3:"非保本R3",IBD:"同存"},period:{T7D:{min:1,max:7},T14D:{min:8,max:14},T1M:{min:15,max:30},T2M:{min:31,max:60},T3M:{min:61,max:90},T6M:{min:91,max:180},T1Y:{min:181,max:360}},periodValue:{},quoteMethod:{},matrixRowName:{SHIBOR:"Shibor",BIG_BANK:"大行",JOINT_STOCK:"股份制",CITY_COMMERCIAL_BANK:"城商行",RURAL_CREDIT:"农信机构",OTHERS:"其他"},bankNature:{SHIBOR:0,BIG_BANK:1,JOINT_STOCK:3,CITY_COMMERCIAL_BANK:4,RURAL_CREDIT:6,OTHERS:99},trustType:{UNLIMIT:0,LIMIT:1}});e.module("moneyMarketApp").service("refreshService",["$interval","$window",function(e,n){this.getCurrentTime=function(){t&&e.cancel(t);var t=e(function(){var e=(new Date).getHours();3===e&&n.location.reload(!0)},18e5)}}]),n.factory("userInterceptor",["$q","$injector","appConfig","qbService",function(e,n,t,r){var o=function(e){return!/(\.html|\.js|\.json|ui\-grid|validateUser|service)/.test(e)};return{request:function(r){if(o(r.url)){t.service_root&&(r.url=t.service_root+r.url);var i=n.get("userinfoService"),a=n.get("$state");i.getUserData(function(e){r.headers.username=e.UserAccount,r.headers.password=e.Password},function(){return a.go("login"),e.reject(r)})}return r.url===t.validate_user&&t.service_root&&(r.url=t.service_root+r.url),r},requestError:function(e){return e},response:function(r){if(o(r.config.url)){var i=r.data;if(r.config.url.endWith(t.get_brother_alliance))return r;if(0===i.return_code)return r;if(i.return_message){var a=n.get("bootbox");a.message(i.return_message.exceptionName)}return e.reject(r)}return r},responseError:function(n){return e.reject(n)}}}]).config(["$httpProvider","$injector",function(e,n){e.interceptors.push("userInterceptor")}]),n.config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,n,t){e.state("app",{"abstract":!0,views:{menu:{templateUrl:"app/commons/menu/index.html",controller:["$scope","$http","offerService","getContacts","qbService","refreshService",function(e,n,t,r,o,i){i.getCurrentTime();var a=void 0,l=void 0;e.allianceClick=function(){t.openReadOnlyModal(function(){},{institution_id:a,last_update:new Date})},e.allianceOpenQM=function(){o.openQM(l)};(function(){r&&(e.contact=r.contact,a=r.institutionId,l=r.qbId)})()}],resolve:{getContacts:["$http","appConfig",function(e,n){var t="402880f034219aed0134219d8b210331",r="402880f034219aed0134219d8b210331";return e.post(n.get_brother_alliance,{institutionId:t}).then(function(e){function n(e){if(e){var n=[],t=[];return e.mobile&&(n=e.mobile.replace(";",",").split(",")),e.telephone&&(t=e.telephone.replace(";",",").split(",")),e.contact=n.concat(t),e}}if(e&&e.data&&e.data.contactsList&&!(e.data.contactsList<=0)&&e.data.contactsList instanceof Array){var o=e.data.contactsList.findItem(function(e){return"王嘉鹏"===e.name}),i=n(o);if(i)return i.institutionId=t,i.qbId=r,i}},function(e){return e.data})}]}},body:{templateUrl:"app/main.html",controller:["$scope","tableService",function(e,n){e.$on("filterChanged",function(n,t){e.$broadcast("refreshMatrix",t)}),e.$on("matrixChanged",function(n,t){e.$broadcast("refreshList",t)}),e.$on("institutionOffer",function(n,t){e.$broadcast("toTableInstitution",t)})}]}}}).state("login",{url:"/login",views:{login:{templateUrl:"app/login/login.html",controller:"loginController",controllerAs:"vm",resolve:{load:["$ocLazyLoad",function(e){return e.load(["app/login/login.js"])}]}}}}).state("app.innerFinancing",{"abstract":!0,url:"/inner",views:{part1:{templateUrl:"app/inner-financing/main.html"}}}).state("app.innerFinancing.index",{url:"",views:{filter:{templateUrl:"app/inner-financing/filter/index.html",controller:"innerFilterController",controllerAs:"vm",resolve:{load:["$ocLazyLoad",function(e){return e.load(["app/inner-financing/filter/filter.js"])}]}},matrix:{templateUrl:"app/inner-financing/matrix/index.html",controller:"innerMatrixController",controllerAs:"vm",resolve:{load:["$ocLazyLoad",function(e){return e.load(["app/inner-financing/matrix/matrix.js"])}]}},table:{templateUrl:"app/commons/table/index.html",controller:"tableController",controllerAs:"vm",resolve:{load:["$ocLazyLoad",function(e){return e.load(["app/commons/table/table.js","app/commons/table/table.service.js"])}],financingType:function(){return"inner"}}}}}).state("app.offlineFinancing",{url:"/offline","abstract":!0,views:{part1:{templateUrl:"app/inner-financing/main.html"}}}).state("app.offlineFinancing.index",{url:"",views:{filter:{templateUrl:"app/offline-financing/filter/index.html",controller:"offlineFilterController",controllerAs:"vm",resolve:{load:["$ocLazyLoad",function(e){return e.load(["app/offline-financing/filter/filter.js"])}]}},matrix:{templateUrl:"app/offline-financing/matrix/index.html",controller:"offlineMatrixController",controllerAs:"vm",resolve:{load:["$ocLazyLoad",function(e){return e.load(["app/offline-financing/matrix/matrix.js"])}]}},table:{templateUrl:"app/commons/table/index.html",controller:"tableController",controllerAs:"vm",resolve:{load:["$ocLazyLoad",function(e){return e.load(["app/commons/table/table.js","app/commons/table/table.service.js"])}],financingType:function(){return"offline"}}}}})}])}(angular);
!function(e){"use strict";var t=e.module("moneyMarketApp");t.controller("innerFilterController",["$uibModal","$scope","areaService","innerFilterService","tableService","offerService","enumConfig",function(e,t,r,a,i,n,o){var s=this;s.quoteType=[],s.areas=[],s.oldAreaList=[],a.getUserArea().success(function(e){var t=e.result;s.boardDirection=n.dataDefine.boardDirection.map(function(e){return{name:e.displayName+"理财",value:e.value}}),s.selectBoardDirection=s.boardDirection[0],s.selectBoardDirection.selected=!0,s.quoteTypeList=t[0].quote_type.slice(0,t[0].quote_type.length-1),s.quoteTypeList[1].selected=!0,s.quoteType=[s.quoteTypeList[1]],s.areaList=[{isAll:!0,name:"全部",selected:!0}].concat(t[0].region.map(function(e){return{name:e.province}})),o.periodValue=t[0].period,o.quoteMethod=t[0].quote_method});var c=function(){for(var e=!1,t=0;t<s.oldAreaList.length;++t){var r=s.oldAreaList[t];if(r.selected){for(var a=!1,i=0;i<s.areaList.length;++i){var n=s.areaList[i];if(n.name==r.name){n.selected=!0,a=!0;break}}if(!a){e=!0;break}}}e&&(s.areaList.forEach(function(e){e.isAll?e.selected=!0:e.selected=!1}),s.areas=[],s.filterChanged())};s.setArea=function(){r.openModal(s.areaList,function(e){a.setUserArea(e.map(function(e){return e.name})).success(function(){s.oldAreaList=s.areaList,s.areaList=[{isAll:!0,name:"全部"}].concat(e),c()})})},s.filterChanged=function(){var e=void 0;s.quoteType[0]&&(e=s.quoteType[0].id);var r=s.areas.map(function(e){return e.name});"全部"==r[0]&&(r=[]);var a=void 0;a=s.selectBoardDirection[0]?s.selectBoardDirection[0].value:n.dataDefine.boardDirection[0].value,i.setFilter(e,r,a),t.$emit("filterChanged","inner")}}]),t.service("innerFilterService",["$http","appConfig",function(e,t){var r=function(){return e.post("base/init_data")},a=function(t){return e.post("base/setarea",{province:t})};this.getUserArea=r,this.setUserArea=a}])}(angular);